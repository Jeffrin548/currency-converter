<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Currency Converter Portfolio</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow-x: hidden;
    }


    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      z-index: -3;
      background: linear-gradient(-45deg, #f70b13, #ff4b19, #f700ff, #4900f4);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
    }

    #particles-js {
        
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: -2;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* CONTAINER */
    .container {
      position: relative;
      z-index: 10;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      width: 320px;
    }

    /* HEADER */
    header {
      position: relative;
      z-index: 10;
      background: rgba(255, 255, 255, 0.85);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #764ba2;
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    }

    .logo img{
        width:120px;
        display:block;
        margin:0 auto 1rem;
    }

    header h1 {
      font-size: 24px;
      color: #4a00e0;
      font-weight: bold;
    }

    button#logout-btn {
      background-color: #db4437;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    /* FORM */
    h2 {
      margin-bottom: 24px;
      font-size: 24px;
      font-weight: bold;
      text-align: center;
      color: #4a00e0;
    }

    input[type="text"], input[type="password"], input[type="email"], input[type="number"], select {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      background-color: #f9f9f9;
    }

    input:focus, select:focus {
      border-color: #764ba2;
      outline: none;
    }

    .btn:hover {
      background: linear-gradient(135deg, #5a67d8, #5a3e8a);
      box-shadow: 0 10px 20px rgba(90, 54, 138, 0.7);
      transform: translateY(-3px);
    }
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 4px 8px rgba(90, 54, 138, 0.5);
    }

    button {
      width: 100%;
      padding: 12px;
      background-color: #ff0059;
      color: white;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 8px;
    }

    button:hover {
      background-color: #0080ff;
    }

    .btn-google {
      background: #fff;
      color: #444;
      border: 1px solid #ccc;
    }

    .error {
      margin-top: 10px;
      color: #b00020;
      text-align: center;
      font-weight: 600;
    }

    /* NAVIGATION */
    nav {
      background: rgba(255, 255, 255, 0.95);
      padding: 10px 20px;
      display: flex;
      gap: 20px;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    nav a {
      text-decoration: none;
      color: #4a00e0;
      font-weight: bold;
    }

    /* CONVERTER */
    .flex {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-top: 30px;
    }

    .left, .right {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }

    .right {
      max-height: 300px;
      overflow-y: auto;
    }

    .result {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: #2f855a;
      text-align: center;
    }

    .hidden {
      display: none;
    }

    .history-item {
      background: #f1f1f1;
      padding: 8px 12px;
      margin-bottom: 8px;
      border-radius: 6px;
      font-size: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* RESPONSIVE */
    @media (max-width: 480px) {
      .card, .left, .right {
        width: 90%;
        padding: 20px;
      }

      nav {
        flex-direction: column;
        gap: 10px;
      }
    }
  </style>
</head>
<body>

<div id="particles-js"></div>

<!-- Landing Page -->
<div id="landing" class="container">
  <div class="card">
    <div class="logo"><img src="conimg.jpg" alt="Logo"></div>
    <h2>Currency Converter</h2>
    <button class="btn" id="try-btn">Try Now for Free!</button>
  </div>
</div>

<!-- Login / Signup -->
<div id="login-signup" class="container hidden">
  <div class="card" id="login-card">
    <div class="logo"><img src="images.png" alt="Logo"></div>
    <h2>Login</h2>
    <input type="text" id="login-username" placeholder="Username">
    <input type="password" id="login-password" placeholder="Password">
    <button class="btn" id="login-btn">Login</button>
    <p style="text-align:center;">New user? <a href="#" id="show-signup">Sign Up</a></p>
    <div class="error" id="login-error"></div>
  </div>

  <div class="card hidden" id="signup-card">
    <h2>Sign Up</h2>
    <input type="text" id="signup-username" placeholder="Username">
    <input type="email" id="signup-email" placeholder="Email">
    <input type="password" id="signup-password" placeholder="Password">
    <button class="btn" id="signup-btn">Sign Up</button>
    <p style="text-align:center;">Already a user? <a href="#" id="show-login">Login</a></p>
    <div class="error" id="signup-error"></div>
  </div>
</div>

<!-- Converter Section -->
<div id="converter-section" class="hidden">
  <nav>
    <a href="#" id="nav-home">Home</a>
    <a href="#" id="nav-about">About</a>
    <a href="#" id="nav-contact">Contact</a>
    <a href="#" id="logout-btn">Logout</a>
  </nav>

  <div id="home-section">
    <h2 style="text-align:center;">Welcome, <span id="user-name"></span>!</h2>
    <div class="flex">
      <div class="left">
        <div class="logo"><img src="conimg.jpg" alt="Logo"></div>
        <h3>Convert Currency</h3>
        <input type="number" id="amount" placeholder="Enter amount">
        <select id="fromCurrency"></select>
        <select id="toCurrency"></select>
        <button class="btn" id="convert-btn">Convert</button>
        <div class="result" id="conversion-result"></div>
        <div class="error" id="converter-error"></div>
      </div>
      <div class="right">
        <h3>History</h3>
        <div id="history-list"></div>
      </div>
    </div>
  </div>

  <div id="about-section" class="hidden">
    <h2>About</h2>
    <p>This is a creative, animated currency converter portfolio.</p>
  </div>

  <div id="contact-section" class="hidden">
    <h2>Contact</h2>
    <ul>
      <li>Beroshin</li>
      <li>Jeffrin</li>
      <li>Bibinesh</li>
    </ul>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script>
  // ParticlesJS Config
  particlesJS("particles-js", {
    particles: {
      number: { value: 120, density: { enable: true, value_area: 800 }},
      color: { value: "#ffffff" },
      shape: { type: "circle" },
      opacity: {
        value: 0.4,
        random: true,
        anim: { enable: true, speed: 0.5, opacity_min: 0.5, sync: false }
      },
      size: { value: 3, random: true },
      line_linked: {
        enable: true,
        distance: 150,
        color: "#ffffff",
        opacity: 0.3,
        width: 1
      },
      move: {
        enable: true,
        speed: 1,
        direction: "none",
        random: false,
        straight: false,
        out_mode: "out"
      }
    },
    interactivity: {
      events: {
        onhover: { enable: true, mode: "repulse" },
        onclick: { enable: true, mode: "push" },
        resize: true
      },
      modes: {
        repulse: { distance: 100, duration: 0.4 },
        push: { particles_nb: 4 }
      }
    },
    retina_detect: true
  });

  // DOM Elements
  const landing = document.getElementById('landing');
  const loginSignup = document.getElementById('login-signup');
  const loginCard = document.getElementById('login-card');
  const signupCard = document.getElementById('signup-card');
  const userName = document.getElementById('user-name');
  const converterSection = document.getElementById('converter-section');
  const historyList = document.getElementById('history-list');
  const navHome = document.getElementById('nav-home');
  const navAbout = document.getElementById('nav-about');
  const navContact = document.getElementById('nav-contact');
  const homeSection = document.getElementById('home-section');
  const aboutSection = document.getElementById('about-section');
  const contactSection = document.getElementById('contact-section');

  // Navigation
  navHome.onclick = () => { homeSection.style.display = 'block'; aboutSection.style.display = 'none'; contactSection.style.display = 'none'; };
  navAbout.onclick = () => { homeSection.style.display = 'none'; aboutSection.style.display = 'block'; contactSection.style.display = 'none'; };
  navContact.onclick = () => { homeSection.style.display = 'none'; aboutSection.style.display = 'none'; contactSection.style.display = 'block'; };

  // Transitions
  document.getElementById('try-btn').onclick = () => { landing.style.display = 'none'; loginSignup.classList.remove('hidden'); };
  document.getElementById('show-signup').onclick = () => { loginCard.classList.add('hidden'); signupCard.classList.remove('hidden'); };
  document.getElementById('show-login').onclick = () => { signupCard.classList.add('hidden'); loginCard.classList.remove('hidden'); };

  // Login/Signup
  document.getElementById('login-btn').onclick = () => {
    const username = document.getElementById('login-username').value;
    const password = document.getElementById('login-password').value;
    fetch('backend.php', {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: `action=login&username=${username}&password=${password}`
    }).then(res => res.json()).then(data => {
      if (data.status == 1) {
        loginSignup.classList.add('hidden');
        converterSection.classList.remove('hidden');
        userName.textContent = data.username;
        loadHistory();
      } else {
        document.getElementById('login-error').textContent = data.message;
      }
    });
  };

  document.getElementById('signup-btn').onclick = () => {
    const username = document.getElementById('signup-username').value;
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-password').value;
    fetch('backend.php', {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: `action=signup&username=${username}&email=${email}&password=${password}`
    }).then(res => res.json()).then(data => {
      if (data.status == 1) {
        document.getElementById('login-btn').click(); // auto-login
      } else {
        document.getElementById('signup-error').textContent = data.message;
      }
    });
  };

  document.getElementById('logout-btn').onclick = () => {
    fetch('backend.php', {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: 'action=logout'
    }).then(() => {
      converterSection.classList.add('hidden');
      loginSignup.classList.remove('hidden');
    });
  };

  // Currency Load
  async function loadCurrencies() {
    try {
      const res = await fetch('https://api.frankfurter.app/currencies');
      const data = await res.json();
      const from = document.getElementById('fromCurrency');
      const to = document.getElementById('toCurrency');
      from.innerHTML = '';
      to.innerHTML = '';
      for (const [code, name] of Object.entries(data)) {
        const option = `<option value="${code}">${name} (${code})</option>`;
        from.innerHTML += option;
        to.innerHTML += option;
      }
    } catch (err) {
      console.error("Error loading currencies:", err);
    }
  }
  loadCurrencies();

  // Convert
  document.getElementById('convert-btn').onclick = async () => {
    const amount = parseFloat(document.getElementById('amount').value);
    const from = document.getElementById('fromCurrency').value;
    const to = document.getElementById('toCurrency').value;
    const resultDiv = document.getElementById('conversion-result');
    const errorDiv = document.getElementById('converter-error');
    resultDiv.textContent = "";
    errorDiv.textContent = "";
    if (isNaN(amount) || amount <= 0) {
      errorDiv.textContent = "Enter a valid amount";
      return;
    }
    try {
      const res = await fetch(`https://api.frankfurter.app/latest?amount=${amount}&from=${from}&to=${to}`);
      const data = await res.json();
      const converted = data.rates[to];
      resultDiv.textContent = `${amount} ${from} = ${converted.toFixed(4)} ${to}`;
      fetch('backend.php', {
        method: 'POST',
        headers: {'Content-Type':'application/x-www-form-urlencoded'},
        body: `action=add_history&from=${from}&to=${to}&amount=${amount}&result=${converted}`
      }).then(() => loadHistory());
    } catch (err) {
      errorDiv.textContent = "Error converting";
    }
  };

  // History
  function loadHistory() {
    fetch('backend.php', {
      method: 'POST',
      headers: {'Content-Type':'application/x-www-form-urlencoded'},
      body: 'action=get_history'
    }).then(res => res.json()).then(data => {
      historyList.innerHTML = "";
      if (data.status == 1 && data.data.length > 0) {
        data.data.forEach(h => {
          const div = document.createElement('div');
          div.className = 'history-item';
          div.innerHTML = `${h.amount} ${h.from_currency} → ${parseFloat(h.result).toFixed(4)} ${h.to_currency}
            <button onclick="deleteHistory(${h.id})">X</button>`;
          historyList.appendChild(div);
        });
      } else {
        historyList.innerHTML = "<p>No history yet.</p>";
      }
    });
  }

  function deleteHistory(id) {
    fetch('backend.php', {
      method:'POST',
      headers:{'Content-Type':'application/x-www-form-urlencoded'},
      body:`action=delete_history&id=${id}`
    }).then(() => loadHistory());
  }
</script>
</body>
</html>
